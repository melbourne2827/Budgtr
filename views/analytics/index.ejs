<% layout('layouts/boilerplate')%>
    <div class="container">
        <div class="row">
            <div class="col-md-7">
                <% var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"] %>
                <h2 class="text-center mt-5">Expected Expenditure (<span class="budget__title--month"><%= months[new Date().getMonth()] %></span>)</h2>
                <table class="table table-hover table-striped mt-3">
                    <thead>
                        <tr class="table-info">
                            <th scope="col">Food</th>
                            <th scope="col">Leisure</th>
                            <th scope="col">Shopping</th>
                            <th scope="col">Misc</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-success">
                            <td scope="row">
                                <%= foodAverage %>
                            </td>
                            <td scope="row">
                                <%= leisureAverage %>
                            </td>
                            <td scope="row">
                                <%= shoppingAverage %>
                            </td>
                            <td scope="row">
                                <%= miscAverage %>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <h2 class="text-center mt-4">Events List (<span class="budget__title--month"><%= months[new Date().getMonth()] %></span>)</h2>
                <table class="table table-striped table-hover mt-3">
                    <thead>
                        <tr class="table-info">
                            <th scope="col">#</th>
                            <th scope="col">Event</th>
                            <th scope="col">Value</th>
                            <th scope="col">Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% events.forEach((element,index)=>{%>
                            <tr class="table-success">
                                <th scope="row">
                                    <%= index+1 %>
                                </th>
                                <td>
                                    <%= element.description %>
                                </td>
                                <td>
                                    <%= element.value %>
                                </td>
                                <td>
                                    <%= element.date.getDate() %>/<%= element.date.getMonth()+1 %>/<%= element.date.getFullYear() %>
                                </td>
                            </tr>
                            <%}) %>
                    </tbody>
                </table>
            </div>
            
            <div class="col-md-5">
                <div style="margin-top: 3em;">
                    <canvas id="pie-chart"></canvas>
                </div>
            </div>
        </div>
    </div>

    <script>
        new Chart(document.getElementById('pie-chart'), {
            type : 'pie',
            data : {
                labels : ["Food", "Leisure", "Shopping", "Misc"],
                datasets : [{
                    backgroundColor : [ "#bee5eb", "#c3e6cb", "#FFC0CB", "#D3D3D3" ],
                    data : [
                        '<%= foodAverage %>',
                         '<%= leisureAverage %>',
                          '<%= shoppingAverage %>',
                          ' <%= miscAverage %>'
                        ]
                }]
            },
        });
    </script>